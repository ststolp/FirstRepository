  <!DOCTYPE html>
         <!-- This is assignment 9 -->
  <html lang="en">
  <head>
    <link rel="stylesheet" type="text/css" href="assign09.css">
    <title>File Name Generator with Ajax</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
   <style>
      button {
          background-color: rgb(62, 106, 247);
          color: white;
           border: 2px solid #4CAF50; 
       }
   </style>
  </head>
 <body>
  <div class="sidemargin">
 <h1>Click button below to generate a table containing my files and directorys</h1>

  <button type="button" onclick="handleRequest()">Run Ajax Request</button>
 </div>

<!-- This div tag will be used to insert the HTML string generated by the AJAX request using the JSON string generated by the assign09.php file -->
  <div class="sidemargin" id="slist">
  </div>
 <script>
var httpRequest;
 function handleRequest()  {
            //Create an HXLHttpRequest object
     httpRequest = new XMLHttpRequest;
             //callback function: the function the server calls while processing request
      httpRequest.onreadystatechange = function() {
               //check to see if the request is finished (with code 4) and if it was successful (with code 200)
         if(httpRequest.readyState == 4 && httpRequest.status == 200) {
   //retrieve the response text:
            var text = httpRequest.responseText;
    //since we know the string being returned is a string JSON obect, parse it.
          var obj = JSON.parse(text);
     //Create an html table using a list. Insert the parsed JSON object with the respective data for each column and cell.
     //The string is inserted into the content of the div tag when the id is slist.
                   var list = "<table border='3'><tr><th>FileName</th><th>Type</th><th>CWD</th><th>Action</th></tr>\n";

                  for (var i = 0; i < obj.length; i++) {
                      list = list + "<tr><td>" + obj[i].fileName + "</td><td>" + obj[i].fileType + "</td><td>" + obj[i].cwd + "</td><td>";
               //add a button to open the file when the file type is file
                    if (obj[i].fileType == "file") {
                       list = list + "<button onclick=\"window.location=\'"
                      + obj[i].cwd + "\'\">Click to Display</button>" + "</td></tr>\n";
               // if its not a file, its a directory. Therefore, leave the action column as an empty string
                      } else { list = list + " " + "</td></tr>\n"; }
                   }

                  document.getElementById("slist").innerHTML = list;
            }
     };
         //open or initialize the file to be processed in GET mode and asynchronous (by passing true)
          httpRequest.open("GET", "assign09.php", true);
      // send the request
                   httpRequest.send();
      }
  </script>
</body>

</html>
